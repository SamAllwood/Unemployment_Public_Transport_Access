# There are only 5 across England and Wales, but this prevents any NAs in the dataset
Pop_2001_corrected_21 <- Pop2021 %>%
left_join(Pop_2001_corrected_21, by = "LSOA21CD") %>%
mutate(Pop_2001_corrected_21 = coalesce(Pop_2001_corrected_21, Usual_Pop_2021)) %>%
dplyr::select(LSOA21CD, Pop_2001_corrected_21)
Pop_2001_corrected_21
# Calculate the scaling factor
sum(Pop2021$Usual_Pop_2021, na.rm = TRUE)/sum(Pop_2001_corrected_21$Pop_2001_corrected_21, na.rm = TRUE)
# Load West Yorkshire Dataset Shapefile ---------------------------------------
WYCA_dataset <- read_sf("../Data/WYCA_dataset.shp") %>%
rename("LSOA21CD" = "LSOA21C",
"LSOA21NM" = "LSOA21N",
"PT_Job_Access_Index" = "PT_Jb_A_I",
"Employed_Population" = "Employd",
"LSOA_Area" = "LSOA__2")
# Join the population datasets to the WYCA dataset
WYCA_population <- WYCA_dataset %>%
left_join(Pop_2001_corrected_21, by = "LSOA21CD") %>%
left_join(Pop2021, by = "LSOA21CD") %>%
dplyr::select(LSOA21CD, LSOA21NM, Pop_2001_corrected_21, Usual_Pop_2021, LSOA_Area) %>%
mutate(Pop_2001_density = Pop_2001_corrected_21 / LSOA_Area) %>%
mutate(Pop_2021_density = Usual_Pop_2021 / LSOA_Area) %>%
mutate(Pop_density_change = Pop_2021_density - Pop_2001_density)
# Average Population Density in WYCA
Total_pop_21 <- sum(WYCA_population$Usual_Pop_2021)
Mean_pop_dens21 <- Total_pop_21 / sum(WYCA_population$LSOA_Area)
Mean_pop_dens21
Total_pop_01 <- sum(WYCA_population$Pop_2001_corrected_21)
Mean_pop_dens01 <- Total_pop_01 / sum(WYCA_population$LSOA_Area)
Mean_pop_dens01
# Add Pop density change variable
WYCA_population <- WYCA_population  %>%
mutate(Pop_density_change = as.numeric(Pop_density_change), # Ensure variable is numeric
Pop_dens_change_cat = cut(Pop_density_change,
breaks = c(-30000, 0, 500, 1500, 30000),
include.lowest = TRUE,
labels = c("dP < 0",
"0 >= dP < 500",
"500 >= dP <1500",
"dP >= 1500")))
# Plot Population Density Change 2001 - 2021
WYCA_population  %>%
filter(as.vector(st_within(., WYCA_bound_small_buffer, sparse = FALSE))) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.5) +
geom_sf(aes(fill = Pop_dens_change_cat), colour = NA) +
scale_fill_brewer() +
labs(fill=" Population Change per
square kilometer",
title = "Population Density Change across WYCA from 2001-2021") +
geom_sf(data=towns_within_WYCA, fill = NA, col = "black", size = 1) +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.79, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.723, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.646, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.796, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.676, label="Wakefield", size=3)+
theme_void()
ggsave(file = "WYCA/Images/Population_Density_Change_WYCA.jpg", device = "jpeg")
# Write as output shapefile
write_sf(WYCA_population, "../Data/WYCA_population.shp")
# Calculate Pop_density quantile breaks
breaks_pop <- classIntervals(WYCA_population$Pop_2021_density, n = 5, style = "quantile")$brks
breaks_pop
labels_pop <- c("<1,200","1,200 - 2,600","2,600 - 4,000","4,000 - 5,700","> 5,700")
WYCA_population  %>%
filter(as.vector(st_within(., WYCA_bound_small_buffer, sparse = FALSE))) %>%
ggplot() +
#          geom_sf(data=WYCA_boundary, colour="black",linewidth=1.5) +
geom_sf(aes(fill = Pop_density_cat), color = NA) +
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_pop) +
labs(fill=" Population per square kilometer
(quintiles)",
title = "Population Density across WYCA in 2021") +
theme_void()
# Create a factor variable for PTJA coloring
WYCA_population$Pop_density_cat <- cut(WYCA_population$Pop_2021_density, breaks = breaks_pop, include.lowest = TRUE, labels = FALSE)
WYCA_population$Pop_density_cat <- as.factor(WYCA_population$Pop_density_cat)
labels_pop <- c("<1,200","1,200 - 2,600","2,600 - 4,000","4,000 - 5,700","> 5,700")
WYCA_population  %>%
filter(as.vector(st_within(., WYCA_bound_small_buffer, sparse = FALSE))) %>%
ggplot() +
#          geom_sf(data=WYCA_boundary, colour="black",linewidth=1.5) +
geom_sf(aes(fill = Pop_density_cat), color = NA) +
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_pop) +
labs(fill=" Population per square kilometer
(quintiles)",
title = "Population Density across WYCA in 2021") +
theme_void()
ggsave(file = "Images/Population_Density_WYCA.jpg", device = "jpeg")
WYCA_population  %>%
filter(as.vector(st_within(., WYCA_bound_small_buffer, sparse = FALSE))) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.5) +
geom_sf(aes(fill = Pop_density_cat), color = NA) +
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_pop) +
labs(fill=" Population per
square kilometer
(quintiles)",
title = "Population Density across WYCA in 2021") +
theme_void()
ggsave(file = "WYCA/Images/Population_Density_WYCA.jpg", device = "jpeg")
### RUN 3.c.PopulationDensityChange_Liverpool.R FIRST to create the accurate Population shapefile
# 1. Setup ----------------------------------------------------------------
options(rgl.useNULL = FALSE)
require(tidyverse)
require(sf)
require(tmap)
require(ggplot2)
require(mapview)
require(stars)
require(rayshader)
require(MetBrewer)
require(colorspace)
require(rayrender)
require(magick)
require(extrafont)
library(stars)
# 2. Load Data ------------------------------------------------------------
# Read population density shapefile from "Population_Density_Change.R" script
WYCA_pop <- read_sf("../Data/LCR_population.shp") %>%
st_transform(4326) %>%
rename("Pop_Dens_change" = "Pp_dns_",
"LSOA21CD" = "LSOA21C",
"Pop_Dens"  = "P_2021_") %>%
dplyr::select(LSOA21CD, Pop_Dens_change, Pop_Dens, geometry)
# check the boundary plot
ggplot(LCR_pop) +
geom_sf(aes(fill = Pop_Dens),
color = "gray66",
linewidth = 0)+
theme_minimal()
# check the boundary plot
ggplot(WYCA_pop) +
geom_sf(aes(fill = Pop_Dens),
color = "gray66",
linewidth = 0)+
theme_minimal()
# 2. Load Data ------------------------------------------------------------
# Read population density shapefile from "Population_Density_Change.R" script
WYCA_pop <- read_sf("../Data/WYCA_population.shp") %>%
st_transform(4326) %>%
rename("Pop_Dens_change" = "Pp_dns_",
"LSOA21CD" = "LSOA21C",
"Pop_Dens"  = "P_2021_") %>%
dplyr::select(LSOA21CD, Pop_Dens_change, Pop_Dens, geometry)
# check the boundary plot
ggplot(WYCA_pop) +
geom_sf(aes(fill = Pop_Dens),
color = "gray66",
linewidth = 0)+
theme_minimal()
# Create Bounding Box -----------------------------------------------------
# setting the boundary as a bounding box
bbox <- st_bbox(WYCA_pop) %>%
st_set_crs(4326)
# finding the aspect ratio
bottom_left <- st_point(c(bbox[["xmin"]], bbox[["ymin"]])) %>%
st_sfc(crs = 4326)
bottom_right <- st_point(c(bbox[["xmax"]], bbox[["ymin"]])) %>%
st_sfc(crs = 4326)
top_left <- st_point(c(bbox[["xmin"]], bbox[["ymax"]])) %>%
st_sfc(crs = 4326)
top_right <- st_point(c(bbox[["xmin"]], bbox[["ymax"]])) %>%
st_sfc(crs = 4326)
width <- st_distance(bottom_left, bottom_right)
height <- st_distance(bottom_left, top_left)
if(width > height) {
w_ratio = 1
h_ratio = height / width
} else {
h_ratio = 1.1
w_ratio = width / height
}
# convert to raster to convert to matrix
# size = 100
size = 250 * 3.5
pop_raster <- st_rasterize(
WYCA_pop,
nx = floor(size * w_ratio) %>% as.numeric(),
ny = floor(size * h_ratio) %>% as.numeric()
)
pop_dens_change_matrix <- matrix(pop_raster$Pop_Dens_change,
nrow = floor(size * w_ratio),
ncol = floor(size * h_ratio))
pop_matrix <- matrix(pop_raster$Pop_Dens,
nrow = floor(size * w_ratio),
ncol = floor(size * h_ratio))
color <- MetBrewer::met.brewer(name="OKeeffe1", direction = -1)
swatchplot(color)
tx <- grDevices::colorRampPalette(color, bias = 2.5)(256)
swatchplot(tx)
# Exclude colors
# Define the range of colors you want to exclude (for example, colors 5 to 10)
exclude_range <- 1:2
exclude_indices <- c(5)
# Create a subset of colors excluding the specified range
subset_colors <- color[setdiff(seq_along(color), exclude_range)]
subset_colors <- color[-exclude_indices]
#view colours in range
swatchplot(subset_colors)
# blend range of colours
tx_subset <- grDevices::colorRampPalette(subset_colors, bias = 1)(256)
swatchplot(tx_subset)
# plotting 3D
# Close any existing 3D plot before plotting another
rgl::close3d()
pop_dens_change_matrix %>%
height_shade(texture = tx) %>%
plot_3d(heightmap = pop_matrix,
zscale = 50,
solid = F,
shadowdepth = 0.8)
# Adjusting Camera Angle
render_camera(theta = 0,
phi = 55,
zoom = 0.45,
fov = 100
)
outfile <- glue::glue("WYCA/Images/WYCA_Pop.png")
{
start_time <- Sys.time()
cat(crayon::cyan(start_time), "\n")
if(!file.exists(outfile)) {
png::writePNG(matrix(1), target = outfile)
}
render_highquality(
filename = outfile,
interactive = TRUE,
lightdirection = 55, #Degree
lightaltitude = c(30, 80),
lightcolor = c("white", "white"),  # Set both lights to white
lightintensity = c(600, 100),
# width = 1980,
# height = 1180
samples = 1000
)
end_time <- Sys.time()
diff <- end_time - start_time
cat(crayon::cyan(diff), "\n")
}
# 1. Setup ----------------------------------------------------------------
library(tidyverse)
library(knitr)
library(tidytransit)
library(mapview)
library(ggmap)
library(sf)
library(ggplot2)
library(ggspatial)
library(classInt)
# 2. Load Data ------------------------------------------------------------
# Load WYCA Geo data from file
WYCA_dataset_PTJA <- read_sf("../Data/WYCA_dataset.shp") %>%
rename("LSOA_Code" = "LSOA21C",
"LSOA_Name" = "LSOA21N",
"PT_Job_Access_Index" = "PT_Jb_A_I",
"PT_Job_Access_Index_bus" = "PT_J_A_I_B",
"PT_Job_Access_Index_train" = "PT_J_A_I_T",
"PT_Job_Access_Index_walk" = "PT_J_A_I_W",
"Employed_Population" = "Employd",
"LSOA_Area" = "LSOA__2",
"Traveltime_empcent" = "Tr__E_C",
"PT_Job_Access_Index_Demand" = "PT_Jb_A_I_") %>%
st_transform(4326) %>%
mutate(PT_Job_Access_Index_bus = PT_Job_Access_Index_bus - PT_Job_Access_Index_walk,
PT_Job_Access_Index_train = PT_Job_Access_Index_train - PT_Job_Access_Index_walk)
WYCA_boundary <- Boundaries %>% filter(CAUTH23NM == "West Yorkshire") %>%
st_transform(4326)
# WYCA Boundary + buffer
Boundaries <- read_sf("../Data/CAUTH_DEC_2023_EN_BFC.shp")
WYCA_boundary <- Boundaries %>% filter(CAUTH23NM == "West Yorkshire") %>%
st_transform(4326)
WYCA_bound_small_buffer <- WYCA_boundary %>% st_buffer(dist=25)
# Town centres
towns_centres_WYCA <- read_sf("../Data/towns_centres_WYCA.shp") %>%
filter(buffer == "N")
# # Plot PTJA index in WYCA ---------------------------------------------
WYCA_dataset_PTJA %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="red",linewidth=1.5)+
geom_sf(aes(fill = PT_Job_Access_Index), col = NA) +
scale_fill_gradient(low="BLACK", high="WHITE") +
labs(fill = "PTJA Index")+
theme_void()
# Plot PTJA index in WYCA by quantile
# Calculate PTJA quantile breaks
breaks_PTJA <- classIntervals(WYCA_dataset_PTJA$PT_Job_Access_Index, n = 5, style = "quantile")$brks
breaks_PTJA[1] <- 00
# Create a factor variable for PTJA coloring
WYCA_dataset_PTJA$color_PTJA <- cut(WYCA_dataset_PTJA$PT_Job_Access_Index, breaks = breaks_PTJA, include.lowest = TRUE, labels = FALSE)
WYCA_dataset_PTJA$color_PTJA <- as.factor(WYCA_dataset_PTJA$color_PTJA)
WYCA_dataset_PTJA$color_PTJA_bus <- cut(WYCA_dataset_PTJA$PT_Job_Access_Index_bus, breaks = breaks_PTJA, include.lowest = TRUE, labels = FALSE)
WYCA_dataset_PTJA$color_PTJA_bus <- as.factor(WYCA_dataset_PTJA$color_PTJA_bus)
WYCA_dataset_PTJA$color_PTJA_train <- cut(WYCA_dataset_PTJA$PT_Job_Access_Index_train, breaks = breaks_PTJA, include.lowest = TRUE, labels = FALSE)
WYCA_dataset_PTJA$color_PTJA_train <- as.factor(WYCA_dataset_PTJA$color_PTJA_train)
labels_PTJA <- c("Lowest PTJA Quintile","","","","Highest PTJA Quintile")
# Plot PTJA by quintile in WYCA
(PTJA <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA) +
labs(fill = "Public Transport
Job Accessibility
(quintiles)") +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-2.88, y=53.40, label="Liverpool", size=3) +
geom_label( x=-2.73, y=53.43, label="St. Helens", size=3) +
geom_label( x=-3.10, y=53.64, label="Southport", size=3) +
geom_label( x=-3.12, y=53.39, label="Birkenhead", size=3) +
annotation_north_arrow(height = unit(1, "cm"),
width = unit(1, "cm"),) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm"))+
theme_void())
# Plot PTJA by quintile in WYCA
(PTJA <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA) +
labs(fill = "Public Transport
Job Accessibility
(quintiles)") +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.79, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.723, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.646, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.796, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.676, label="Wakefield", size=3)+
annotation_north_arrow(height = unit(1, "cm"),
width = unit(1, "cm"),) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm"))+
theme_void())
# Plot PTJA by quintile in WYCA
(PTJA <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA) +
labs(fill = "PTJA
(quintiles)",
title = "Public Transport Job Accessibility in West Yorkshire Combined Authority") +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.85, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.78, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.70, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.85, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.72, label="Wakefield", size=3)+
annotation_north_arrow(height = unit(1, "cm"),
width = unit(1, "cm"),) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm"))+
theme_void())
View(WYCA_bound_small_buffer)
View(towns_centres_WYCA)
# Plot PTJA by quintile in WYCA
(PTJA <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA) +
labs(fill = "PTJA
(quintiles)",
title = "Public Transport Job Accessibility in West Yorkshire Combined Authority") +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.85, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.75, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.68, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.825, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.70, label="Wakefield", size=3)+
annotation_north_arrow(height = unit(1, "cm"),
width = unit(1, "cm"),) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm"))+
theme_void())
# Plot PTJA by quintile in WYCA
(PTJA <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA) +
labs(fill = "PTJA
(quintiles)",
title = "Public Transport Job Accessibility in West Yorkshire Combined Authority") +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.83, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.75, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.675, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.825, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.70, label="Wakefield", size=3)+
annotation_north_arrow(height = unit(1, "cm"),
width = unit(1, "cm"),) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm"))+
theme_void())
ggsave(file = "WYCA/Images/PTJA.jpeg", device = "jpeg", plot = PTJA)
breaks_PTJA_D <- classIntervals(WYCA_dataset_PTJA$PT_Job_Access_Index_Demand,
n = 5,
style = "quantile")$brks
breaks_PTJA_D[1] <- 00
# Create a factor variable for PTJA coloring
WYCA_dataset_PTJA$color_PTJA_D <- cut(WYCA_dataset_PTJA$PT_Job_Access_Index_Demand,
breaks = breaks_PTJA_D,
include.lowest = TRUE,
labels = FALSE) %>%
as.factor()
labels_PTJA_D <- c("Lowest PTJA-D Quintile","","","","Highest PTJA-D Quintile")
# Plot PTJA by quintile in WYCA
(PTJA_D <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA_D, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA_D), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA_D) +
labs(fill = "Public Transport
Job Accessibility
(Demand-adjusted)
(quintiles)")+
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.79, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.723, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.646, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.796, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.676, label="Wakefield", size=3)+
annotation_north_arrow( height = unit(1, "cm"),
width = unit(1, "cm")) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm")) +
theme_void())
# Plot PTJA by quintile in WYCA
(PTJA_D <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA_D, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA_D), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA_D) +
labs(fill = "PTJA-D
(quintiles)",
title = "Public Transport Job Accessibility (Demand-adjusted) in West Yorkshire Combined Authority") +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.83, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.75, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.675, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.825, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.70, label="Wakefield", size=3)+
annotation_north_arrow( height = unit(1, "cm"),
width = unit(1, "cm")) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm")) +
theme_void())
ggsave(file = "WYCA/Images/PTJA_D.jpeg", device = "jpeg", plot = PTJA_D)
# Plot PTJA by quintile in WYCA
(PTJA_D <- WYCA_dataset_PTJA %>%
dplyr::select(color_PTJA_D, geometry) %>%
ggplot() +
geom_sf(data=WYCA_boundary, colour="black",linewidth=1.0) +
geom_sf(data = WYCA_dataset_PTJA, aes(fill = color_PTJA_D), color = NA) + # color = NA removes the LSOA boundaries
scale_fill_brewer(palette = "Spectral",
direction = -1,
labels = labels_PTJA_D) +
labs(fill = "PTJA-D
(quintiles)",
title = "Public Transport Job Accessibility (Demand-adjusted) in
West Yorkshire Combined Authority") +
geom_sf(data=towns_centres_WYCA, shape = 21, fill = 'white', size = 1.5) +
geom_label( x=-1.756, y=53.83, label="Bradford", size=3) +
geom_label( x=-1.859, y=53.75, label="Halifax", size=3) +
geom_label( x=-1.782, y=53.675, label="Huddersfield", size=3) +
geom_label( x=-1.545, y=53.825, label="Leeds", size=3) +
geom_label( x=-1.5058, y=53.70, label="Wakefield", size=3)+
annotation_north_arrow( height = unit(1, "cm"),
width = unit(1, "cm")) +
annotation_scale(location = "bl",
pad_x = unit(2.5, "cm"),
pad_y = unit(0, "cm")) +
theme_void())
ggsave(file = "WYCA/Images/PTJA_D.jpeg", device = "jpeg", plot = PTJA_D)
